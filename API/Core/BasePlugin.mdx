---
title: BasePlugin 类
description: CounterStrikeSharp 插件系统的基类，提供了插件开发所需的基本功能
icon: Box
---

# BasePlugin 类

`BasePlugin` 是一个抽象类，实现了 `IPlugin` 接口，为插件开发提供了基本功能和实用方法。所有 CounterStrikeSharp 插件都应该继承自这个类。

## 命名空间

```csharp
namespace CounterStrikeSharp.API.Core
```

## 类定义

```csharp
public abstract class BasePlugin : IPlugin
```

## 属性

### ModuleName

获取插件名称（必须在派生类中实现）。

```csharp
public abstract string ModuleName { get; }
```

### ModuleVersion

获取插件版本（必须在派生类中实现）。

```csharp
public abstract string ModuleVersion { get; }
```

### ModuleAuthor

获取插件作者（可选重写）。

```csharp
public virtual string ModuleAuthor { get; }
```

### ModuleDescription

获取插件描述（可选重写）。

```csharp
public virtual string ModuleDescription { get; }
```

### ModulePath

获取或设置插件DLL文件的路径。

```csharp
public string ModulePath { get; set; }
```

### ModuleDirectory

获取插件所在目录的路径。

```csharp
public string ModuleDirectory { get; }
```

### Logger

获取或设置日志记录器。

```csharp
public ILogger Logger { get; set; }
```

### CommandManager

获取或设置命令管理器。

```csharp
public ICommandManager CommandManager { get; set; }
```

### Localizer

获取或设置本地化器。

```csharp
public IStringLocalizer Localizer { get; set; }
```

## 方法

### 事件处理

#### RegisterEventHandler&lt;T&gt;

注册游戏事件处理器。

```csharp
public void RegisterEventHandler<T>(GameEventHandler<T> handler, HookMode hookMode = HookMode.Post) where T : GameEvent
```

##### 参数

- `handler`: `GameEventHandler<T>` - 事件处理器委托
- `hookMode`: `HookMode` - 钩子模式，默认为 `HookMode.Post`

#### DeregisterEventHandler&lt;T&gt;

注销游戏事件处理器。

```csharp
public void DeregisterEventHandler<T>(GameEventHandler<T> handler, HookMode hookMode = HookMode.Post) where T : GameEvent
```

### 命令管理

#### AddCommand

注册一个新的服务器命令。

```csharp
public void AddCommand(string name, string description, CommandInfo.CommandCallback handler)
```

##### 参数

- `name`: `string` - 命令名称
- `description`: `string` - 命令描述
- `handler`: `CommandInfo.CommandCallback` - 命令处理回调函数

#### AddCommandListener

添加命令监听器。

```csharp
public void AddCommandListener(string? name, CommandInfo.CommandListenerCallback handler, HookMode mode = HookMode.Pre)
```

##### 参数

- `name`: `string?` - 命令名称，例如 `jointeam`
- `handler`: `CommandInfo.CommandListenerCallback` - 命令监听回调函数
- `mode`: `HookMode` - 钩子模式，默认为 `HookMode.Pre`

#### RemoveCommand

移除服务器命令。

```csharp
public void RemoveCommand(string name, CommandInfo.CommandCallback handler)
```

#### RemoveCommandListener

移除命令监听器。

```csharp
public void RemoveCommandListener(string name, CommandInfo.CommandListenerCallback handler, HookMode mode)
```

## 生命周期方法

### Load

插件加载时调用的方法（可选重写）。

```csharp
public virtual void Load(bool hotReload)
```

### Unload

插件卸载时调用的方法（可选重写）。

```csharp
public virtual void Unload(bool hotReload)
```

### OnAllPluginsLoaded

所有插件加载完成后调用的方法（可选重写）。

```csharp
public virtual void OnAllPluginsLoaded(bool hotReload)
```

## 使用示例

```csharp
public class MyPlugin : BasePlugin
{
    public override string ModuleName => "示例插件";
    public override string ModuleVersion => "1.0.0";
    public override string ModuleAuthor => "作者名称";
    public override string ModuleDescription => "这是一个示例插件";

    public override void Load(bool hotReload)
    {
        // 注册命令
        AddCommand("hello", "打招呼命令", (player, info) =>
        {
            if (player != null)
            {
                player.PrintToChat("你好！");
            }
            return HookResult.Continue;
        });

        // 注册事件处理器
        RegisterEventHandler<EventPlayerDeath>((ev, info) =>
        {
            Logger.LogInformation($"玩家 {ev.Userid.PlayerName} 死亡");
            return HookResult.Continue;
        });
    }

    public override void Unload(bool hotReload)
    {
        // 清理资源
    }
}
``` 