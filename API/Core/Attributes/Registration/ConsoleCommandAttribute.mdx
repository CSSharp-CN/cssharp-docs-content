---
title: ConsoleCommandAttribute
sidebar_position: 1
tags: [core, attributes, commands]
---

# ConsoleCommandAttribute 类

`ConsoleCommandAttribute` 是一个特性类，用于将方法标记为控制台命令处理器。它允许通过特性声明的方式注册命令。

## 特性用法

```csharp
[AttributeUsage(AttributeTargets.Method, AllowMultiple = true)]
```

- 只能应用于方法
- 允许在同一个方法上多次使用此特性

## 构造函数

### ConsoleCommandAttribute
```csharp
public ConsoleCommandAttribute(string command, string description = null)
```

创建一个新的控制台命令特性实例。

#### 参数
- `command`: 命令名称
- `description`: 命令描述（可选）

## 属性

### Command
```csharp
public string Command { get; }
```

获取命令名称。

### Description
```csharp
public string Description { get; }
```

获取命令描述。

## 使用示例

```csharp
public class MyPlugin : BasePlugin
{
    // 基本命令
    [ConsoleCommand("hello", "一个简单的问候命令")]
    public HookResult OnHelloCommand(CCSPlayerController? player, CommandInfo info)
    {
        info.ReplyToCommand("你好！");
        return HookResult.Continue;
    }

    // 带参数的命令
    [ConsoleCommand("say_to", "向指定玩家发送消息")]
    public HookResult OnSayToCommand(CCSPlayerController? player, CommandInfo info)
    {
        if (info.ArgCount < 3)
        {
            info.ReplyToCommand("用法: !say_to <玩家名> <消息>");
            return HookResult.Continue;
        }

        var targetName = info.GetArg(1);
        var message = info.GetArg(2);
        
        var target = Utilities.GetPlayerFromName(targetName);
        if (target == null)
        {
            info.ReplyToCommand($"找不到玩家: {targetName}");
            return HookResult.Continue;
        }

        target.PrintToChat($"消息来自 {player?.PlayerName ?? "控制台"}: {message}");
        return HookResult.Continue;
    }

    // 多个命令共用一个处理器
    [ConsoleCommand("stats", "显示统计信息")]
    [ConsoleCommand("score", "显示得分")]
    public HookResult OnStatsCommand(CCSPlayerController? player, CommandInfo info)
    {
        if (player == null)
        {
            info.ReplyToCommand("此命令只能由玩家使用！");
            return HookResult.Continue;
        }

        var command = info.GetArg(0).ToLower();
        switch (command)
        {
            case "stats":
                ShowPlayerStats(player);
                break;
            case "score":
                ShowPlayerScore(player);
                break;
        }

        return HookResult.Continue;
    }

    private void ShowPlayerStats(CCSPlayerController player)
    {
        // 显示玩家统计信息
    }

    private void ShowPlayerScore(CCSPlayerController player)
    {
        // 显示玩家得分
    }
}
```

## 注意事项

- 命令名称应该是唯一的
- 命令处理方法必须有正确的参数类型
- 可以在一个方法上注册多个命令
- 建议提供清晰的命令描述
- 命令处理方法应该返回 `HookResult`
- 注意处理 `player` 参数可能为 `null` 的情况
- 使用 `CommandInfo` 参数获取命令信息
- 命令会自动注册和卸载
- 支持热重载