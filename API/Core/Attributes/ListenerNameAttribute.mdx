---
title: ListenerNameAttribute
sidebar_position: 2
tags: [core, attributes, events]
---

# ListenerNameAttribute 类

`ListenerNameAttribute` 是一个特性类，用于将委托与监听器名称关联起来。它只能应用于委托，并且不会被继承。

## 特性用法

```csharp
[AttributeUsage(AttributeTargets.Delegate, Inherited = false)]
```

- 只能应用于委托
- 不会被继承
- 每个委托只能使用一次

## 构造函数

### ListenerNameAttribute
```csharp
public ListenerNameAttribute(string name)
```

创建一个新的监听器名称特性实例。

#### 参数
- `name`: 监听器的名称

## 属性

### Name
```csharp
public string Name { get; init; }
```

获取监听器的名称。

## 使用示例

```csharp
// 定义事件监听器委托
[ListenerName("OnPlayerConnect")]
public delegate HookResult PlayerConnectHandler(CCSPlayerController player);

[ListenerName("OnMapStart")]
public delegate HookResult MapStartHandler(string mapName);

[ListenerName("OnWeaponEquip")]
public delegate HookResult WeaponEquipHandler(CCSPlayerController player, CBasePlayerWeapon weapon);

// 在插件中使用监听器
public class MyPlugin : BasePlugin
{
    private PlayerConnectHandler _connectHandler;
    private MapStartHandler _mapStartHandler;
    private WeaponEquipHandler _weaponEquipHandler;

    public override void Load(bool hotReload)
    {
        // 注册玩家连接监听器
        _connectHandler = OnPlayerConnect;
        AddListener(_connectHandler);

        // 注册地图开始监听器
        _mapStartHandler = OnMapStart;
        AddListener(_mapStartHandler);

        // 注册武器装备监听器
        _weaponEquipHandler = OnWeaponEquip;
        AddListener(_weaponEquipHandler);
    }

    private HookResult OnPlayerConnect(CCSPlayerController player)
    {
        if (player != null && player.IsValid)
        {
            Server.PrintToChatAll($"玩家 {player.PlayerName} 已连接到服务器！");
        }
        return HookResult.Continue;
    }

    private HookResult OnMapStart(string mapName)
    {
        Logger.LogInformation($"地图 {mapName} 已开始加载");
        return HookResult.Continue;
    }

    private HookResult OnWeaponEquip(CCSPlayerController player, CBasePlayerWeapon weapon)
    {
        if (player != null && weapon != null)
        {
            player.PrintToChat($"你装备了 {weapon.DesignerName}");
        }
        return HookResult.Continue;
    }

    public override void Unload(bool hotReload)
    {
        // 移除监听器
        RemoveListener(_connectHandler);
        RemoveListener(_mapStartHandler);
        RemoveListener(_weaponEquipHandler);
    }
}
```

## 注意事项

- 监听器名称必须是有效的游戏事件
- 委托参数类型必须与事件数据匹配
- 特性只能用于委托定义
- 不支持继承，每个委托都需要单独标记
- 监听器名称区分大小写
- 建议使用有意义的委托名称
- 确保正确移除不再使用的监听器
- 监听器可以在运行时动态添加和移除
- 支持多个监听器监听同一个事件
- 可以与其他事件相关特性配合使用